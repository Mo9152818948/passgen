<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Ø³Ø§Ø²Ù†Ø¯Ù‡Ù” Ø±Ù…Ø² Ùˆ Ø§ÛŒÙ…ÛŒÙ„ Ù‚ÙˆÛŒ</title>

<!-- PWA -->
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0f172a">

<style>
:root{
  --bg:#0b1220; --fg:#e5e7eb; --card:#0f172a; --muted:#1f2937; --btn:#16a34a; --btn-fg:#07110a;
}
*{box-sizing:border-box} body{margin:0; font-family: Vazirmatn,iransans,sans-serif; color:var(--fg); background:var(--bg); min-height:100vh;}
.container{max-width:860px;margin:24px auto;padding:16px}
.card{background:var(--card); border-radius:18px; box-shadow:0 10px 30px rgba(0,0,0,.25); padding:22px; backdrop-filter: blur(6px);}
h1{margin:0 0 12px; font-size:28px}
.row{display:flex; gap:12px; flex-wrap:wrap; align-items:center}
label{display:inline-flex; align-items:center; gap:8px; font-size:14px}
input[type=number]{width:88px; padding:8px 10px; border-radius:10px; border:1px solid var(--muted); background:transparent; color:var(--fg)}
select{padding:9px 12px; border-radius:12px; border:1px solid var(--muted); background:transparent; color:var(--fg)}
button{border:none; border-radius:12px; padding:10px 14px; background:var(--btn); color:var(--btn-fg); cursor:pointer; font-weight:600}
button.secondary{background:transparent;color:var(--fg); border:1px solid var(--muted)}
.password{display:flex; justify-content:space-between; align-items:center; background:rgba(255,255,255,.06); padding:10px 12px; border-radius:12px; font-family:ui-monospace,monospace}
.list{display:grid; gap:8px; margin-top:12px}
small{opacity:.8}

/* ØªÙ…â€ŒÙ‡Ø§ */
.theme-light{--bg:#f8fafc; --fg:#0f172a; --card:#ffffff; --muted:#e2e8f0; --btn:#0f172a; --btn-fg:#ffffff;}
.theme-dark{--bg:#0b1220; --fg:#e5e7eb; --card:#0f172a; --muted:#1f2937; --btn:#16a34a; --btn-fg:#07110a;}
.theme-blue{--bg:#e6f0ff; --fg:#0b1a33; --card:#ffffff; --muted:#d9e6ff; --btn:#1d4ed8; --btn-fg:#ffffff;}
.theme-purple{--bg:#f5f0ff; --fg:#27104a; --card:#ffffff; --muted:#eadbff; --btn:#7c3aed; --btn-fg:#ffffff;}
.theme-gradient{--fg:#0f172a; --btn:#111827; --btn-fg:#ffffff;}
.theme-gradient body,.theme-gradient{background:linear-gradient(135deg,#2563eb 0%,#7c3aed 60%,#9333ea 100%) fixed;}

/* Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ú¯ÛŒ/ØªØµÙˆÛŒØ±ÛŒ */
.bg-1{background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%) fixed;}
.bg-2{background:linear-gradient(135deg,#a1c4fd 0%,#c2e9fb 100%) fixed;}
.bg-3{background:linear-gradient(135deg,#d4fc79 0%,#96e6a1 100%) fixed;}
.bg-4{background:linear-gradient(135deg,#fbc2eb 0%,#a6c1ee 100%) fixed;}
@media (max-width:520px){ .row>*{flex:1 1 auto} h1{font-size:22px} }
</style>
</head>
<body class="theme-dark">
<div class="container">
  <div class="card">
    <h1>ğŸ” Ø³Ø§Ø²Ù†Ø¯Ù‡Ù” Ø±Ù…Ø² Ùˆ Ø§ÛŒÙ…ÛŒÙ„ Ù‚ÙˆÛŒ <small>â€” Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</small></h1>

    <div class="row" style="margin-bottom:6px">
      <label>Ø·ÙˆÙ„ Ø±Ù…Ø²: <input type="number" id="length" value="12" min="6" max="64"></label>
      <label>ØªØ¹Ø¯Ø§Ø¯ Ø®Ø±ÙˆØ¬ÛŒ: <input type="number" id="count" value="5" min="1" max="50"></label>

      <label>ØªÙ…:
        <select id="theme">
          <option value="dark">ØªÛŒØ±Ù‡</option>
          <option value="light">Ø±ÙˆØ´Ù†</option>
          <option value="blue">Ø¢Ø¨ÛŒ</option>
          <option value="purple">Ø¨Ù†ÙØ´</option>
          <option value="gradient">Ú¯Ø±Ø§Ø¯ÛŒØ§Ù†Øª</option>
        </select>
      </label>
      <button id="btnBg" class="secondary">ğŸŒ† Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡</button>
    </div>

    <div class="row">
      <label><input type="checkbox" id="lower" checked> Ø­Ø±ÙˆÙ Ú©ÙˆÚ†Ú©</label>
      <label><input type="checkbox" id="upper" checked> Ø­Ø±ÙˆÙ Ø¨Ø²Ø±Ú¯</label>
      <label><input type="checkbox" id="digits" checked> Ø§Ø¹Ø¯Ø§Ø¯</label>
      <label><input type="checkbox" id="symbols" checked> Ù†Ù…Ø§Ø¯Ù‡Ø§</label>
    </div>
    <div class="row">
      <label><input type="checkbox" id="noSimilar"> Ø­Ø°Ù Ù…Ø´Ø§Ø¨Ù‡â€ŒÙ‡Ø§</label>
      <label><input type="checkbox" id="noRepeat"> Ø¨Ø¯ÙˆÙ† ØªÚ©Ø±Ø§Ø±</label>
      <label><input type="checkbox" id="requireEach" checked> ÙˆØ¬ÙˆØ¯ Ø§Ø² Ù‡Ø± Ú¯Ø±ÙˆÙ‡</label>
    </div>

    <!-- Ø§ÛŒÙ…ÛŒÙ„ Gmail -->
    <div class="row" style="margin:10px 0">
      <label>Ø·ÙˆÙ„ Ø§ÛŒÙ…ÛŒÙ„: <input type="number" id="emailLen" value="10" min="6" max="30"></label>
      <label><input type="checkbox" id="emailDot" checked> Ù†Ù‚Ø·Ù‡ Ù…Ø¬Ø§Ø²</label>
      <button id="btnEmail" class="secondary">âœ‰ï¸ ØªÙˆÙ„ÛŒØ¯ Gmail</button>
    </div>

    <div class="row">
      <button id="btnGen">ğŸ² ØªÙˆÙ„ÛŒØ¯ Ø±Ù…Ø²</button>
      <button id="btnCSV" class="secondary">CSV</button>
      <button id="btnJSON" class="secondary">JSON</button>
      <button id="btnToggle" class="secondary">ğŸ‘ï¸ Ù†Ù…Ø§ÛŒØ´/Ù…Ø®ÙÛŒ</button>
    </div>

    <div id="output" class="list"></div>
  </div>
</div>

<script>
// ----- ØªÙ…â€ŒÙ‡Ø§ -----
const THEME_KEY="theme", BG_KEY="bg";
const themeSelect=document.getElementById("theme");
function applyTheme(name){
  document.body.classList.remove("theme-light","theme-dark","theme-blue","theme-purple","theme-gradient");
  document.body.classList.add("theme-"+name);
  localStorage.setItem(THEME_KEY,name);
}
(function(){const s=localStorage.getItem(THEME_KEY)||"dark";themeSelect.value=s;applyTheme(s);})();
themeSelect.addEventListener("change",e=>applyTheme(e.target.value));

// ----- Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ -----
const BG_CLASSES=["bg-1","bg-2","bg-3","bg-4"]; let bgIndex=-1;
function applyBg(i){document.body.classList.remove(...BG_CLASSES); if(i>-1)document.body.classList.add(BG_CLASSES[i]);}
(function(){const saved=localStorage.getItem(BG_KEY); if(saved!==null){bgIndex=parseInt(saved,10); applyBg(bgIndex);}})();
document.getElementById("btnBg").onclick=()=>{bgIndex=(bgIndex+1)%(BG_CLASSES.length+1); if(bgIndex===BG_CLASSES.length){bgIndex=-1; applyBg(-1);} else applyBg(bgIndex); localStorage.setItem(BG_KEY,bgIndex);};

// ----- Ø§Ø¨Ø²Ø§Ø± ØªØµØ§Ø¯ÙÛŒ Ø§Ù…Ù† -----
function rnd(max){const a=new Uint32Array(1);const M=0xffffffff,lim=Math.floor(M/max)*max;let r;do{crypto.getRandomValues(a);r=a[0];}while(r>=lim);return r%max;}
function pick(s){return s[rnd(s.length)];}
function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=rnd(i+1);[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

// ----- Ø³Ø§Ø®Øª Ù¾Ø³ÙˆØ±Ø¯ -----
const sets={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",digits:"0123456789",symbols:"!@#$%^&*()_-+=[]{}|:;,.?/~`<>"},
      similar=new Set("Il1O0B8S5Z2".split(""));
function buildPool(o){let groups=[]; if(o.lower)groups.push(sets.lower); if(o.upper)groups.push(sets.upper); if(o.digits)groups.push(sets.digits); if(o.symbols)groups.push(sets.symbols);
  if(o.noSimilar)groups=groups.map(g=>[...g].filter(c=>!similar.has(c)).join("")); return {groups, all:groups.join("")};}
function genPass(o){const {groups,all}=buildPool(o); if(!all)return""; const L=o.length,chs=[]; if(o.requireEach)groups.forEach(g=>chs.push(pick(g)));
  while(chs.length<L){const c=pick(all); if(o.noRepeat && chs.length && chs[chs.length-1]===c) continue; chs.push(c);} return shuffle(chs).slice(0,L).join("");}

// ----- Ø³Ø§Ø®Øª Ø¬ÛŒÙ…ÛŒÙ„ -----
const letters="abcdefghijklmnopqrstuvwxyz", nums="0123456789";
function genGmailLocal(L,allowDot){let allowed=(allowDot?letters+nums+".":letters+nums),s=letters[rnd(letters.length)];
  while(s.length<L){const c=pick(allowed); if(c==="."&&(s[s.length-1]==="."||s.length===L-1)) continue; s+=c;}
  if(s.endsWith(".")) s=s.slice(0,-1)+letters[rnd(letters.length)]; return s;}

// ----- Ù†Ù…Ø§ÛŒØ´ -----
let last=[], hidden=false;
function render(list){last=list; const out=document.getElementById("output"); out.innerHTML="";
  list.forEach(x=>{const row=document.createElement("div"); row.className="password";
    const span=document.createElement("span"); span.textContent=hidden?"â€¢".repeat(x.length):x; span.dataset.real=x;
    const copy=document.createElement("button"); copy.className="secondary"; copy.textContent="ğŸ“‹ Ú©Ù¾ÛŒ";
    copy.onclick=()=>navigator.clipboard.writeText(x);
    row.appendChild(span); row.appendChild(copy); out.appendChild(row);});
}
function opts(){return{lower:lower.checked,upper:upper.checked,digits:digits.checked,symbols:symbols.checked,noSimilar:noSimilar.checked,noRepeat:noRepeat.checked,requireEach:requireEach.checked,length:parseInt(length.value||12)};}
function genMany(){const c=Math.min(100,Math.max(1,parseInt(count.value||5))); const o=opts(); const arr=[]; for(let i=0;i<c;i++) arr.push(genPass(o)); render(arr);}

btnGen.onclick=genMany;
btnEmail.onclick=()=>{const c=Math.min(100,Math.max(1,parseInt(count.value||5))); let L=parseInt(emailLen.value||10); if(isNaN(L))L=10; L=Math.max(6,Math.min(30,L));
  const arr=[]; for(let i=0;i<c;i++) arr.push(genGmailLocal(L,emailDot.checked)+"@gmail.com"); render(arr); }
btnCSV.onclick=()=>{if(!last.length)return; const b=new Blob([last.join("\n")],{type:"text/csv"}); const a=document.createElement("a"); a.href=URL.createObjectURL(b); a.download="output.csv"; a.click();}
btnJSON.onclick=()=>{if(!last.length)return; const b=new Blob([JSON.stringify(last,null,2)],{type:"application/json"}); const a=document.createElement("a"); a.href=URL.createObjectURL(b); a.download="output.json"; a.click();}
btnToggle.onclick=()=>{hidden=!hidden; document.querySelectorAll("#output .password span").forEach(el=>{el.textContent=hidden?"â€¢".repeat(el.dataset.real.length):el.dataset.real;});}

// ØªÙˆÙ„ÛŒØ¯ Ø§ÙˆÙ„ÛŒÙ‡
genMany();
</script>

<!-- Ø«Ø¨Øª Ø³Ø±ÙˆÛŒØ³â€ŒÙˆØ±Ú©Ø± -->
<script>
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('./sw.js').catch(console.log);
}
</script>
</body>
</html>
