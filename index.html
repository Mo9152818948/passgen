<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>سازنده رمز قوی – PWA</title>
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0f172a">
<style>
:root{--bg:#f8fafc;--fg:#0f172a;--card:#ffffff;--muted:#e2e8f0;--btn:#0f172a;--btn-fg:#ffffff;}
*{box-sizing:border-box}
body{margin:0;font-family:Vazirmatn,sans-serif;background:var(--bg);color:var(--fg);}
.container{max-width:720px;margin:24px auto;padding:16px}
.card{background:var(--card);border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.08);padding:20px}
h1{margin:0 0 12px;font-size:22px}
.row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
label{display:inline-flex;align-items:center;gap:8px}
input[type=number]{width:84px;padding:6px 8px;border-radius:10px;border:1px solid var(--muted)}
select{padding:8px 10px;border-radius:12px;border:1px solid var(--muted)}
button{border:none;border-radius:12px;padding:10px 14px;background:var(--btn);color:var(--btn-fg);cursor:pointer}
button.secondary{background:transparent;color:var(--fg);border:1px solid var(--muted)}
.password{display:flex;justify-content:space-between;align-items:center;background:var(--muted);padding:8px 12px;border-radius:12px;font-family:ui-monospace,monospace}
.list{display:grid;gap:8px;margin-top:10px}
small{opacity:.7}
/* تم‌ها */
.theme-light{--bg:#f8fafc;--fg:#0f172a;--card:#ffffff;--muted:#e2e8f0;--btn:#0f172a;--btn-fg:#ffffff;}
.theme-dark{--bg:#0b1220;--fg:#e5e7eb;--card:#0f172a;--muted:#1f2937;--btn:#16a34a;--btn-fg:#07110a;}
.theme-blue{--bg:#e6f0ff;--fg:#0b1a33;--card:#ffffff;--muted:#d9e6ff;--btn:#1d4ed8;--btn-fg:#ffffff;}
.theme-purple{--bg:#f5f0ff;--fg:#27104a;--card:#ffffff;--muted:#eadbff;--btn:#7c3aed;--btn-fg:#ffffff;}
.theme-gradient{--fg:#0f172a;--btn:#111827;--btn-fg:#ffffff;}
.theme-gradient body,.theme-gradient{background:linear-gradient(135deg,#d9f99d 0%,#a5b4fc 50%,#f0abfc 100%);}
.bg-1{background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%) fixed;}
.bg-2{background:linear-gradient(135deg,#a1c4fd 0%,#c2e9fb 100%) fixed;}
.bg-3{background:linear-gradient(135deg,#d4fc79 0%,#96e6a1 100%) fixed;}
.bg-4{background:linear-gradient(135deg,#fbc2eb 0%,#a6c1ee 100%) fixed;}
.bg-img-1{background:url('https://picsum.photos/1600/900?blur=3') no-repeat center center fixed;background-size:cover;}
.bg-img-2{background:url('https://images.unsplash.com/photo-1503264116251-35a269479413?q=80&w=1600&auto=format&fit=crop') no-repeat center center fixed;background-size:cover;}
@media(max-width:480px){.row>*{flex:1 1 auto}}
</style>
</head>
<body>
<div class="container">
  <div class="card">
    <h1>🔐 سازندهٔ رمز قوی <small>— پسورد + ایمیل Gmail</small></h1>
    <div class="row">
      <label>طول رمز: <input type="number" id="length" value="12" min="6" max="64"></label>
      <label>تعداد: <input type="number" id="count" value="5" min="1" max="50"></label>
      <label>تم:
        <select id="theme">
          <option value="light">روشن</option>
          <option value="dark">تیره</option>
          <option value="blue">آبی</option>
          <option value="purple">بنفش</option>
          <option value="gradient">گرادیانت</option>
        </select>
      </label>
      <button id="btnBg" class="secondary">🌆 پس‌زمینه</button>
    </div>
    <div class="row">
      <label><input type="checkbox" id="lower" checked> کوچک</label>
      <label><input type="checkbox" id="upper" checked> بزرگ</label>
      <label><input type="checkbox" id="digits" checked> اعداد</label>
      <label><input type="checkbox" id="symbols" checked> نماد</label>
    </div>
    <div class="row">
      <label><input type="checkbox" id="noSimilar"> حذف مشابه</label>
      <label><input type="checkbox" id="noRepeat"> بدون تکرار</label>
      <label><input type="checkbox" id="requireEach" checked> از هر گروه</label>
    </div>
    <div class="row">
      <label>طول ایمیل: <input type="number" id="emailLen" value="10" min="6" max="30"></label>
      <label><input type="checkbox" id="emailDot" checked> نقطه مجاز</label>
      <button id="btnEmail" class="secondary">✉️ تولید Gmail</button>
    </div>
    <div class="row">
      <button id="btnGen">🎲 رمز</button>
      <button id="btnCSV" class="secondary">CSV</button>
      <button id="btnJSON" class="secondary">JSON</button>
      <button id="btnToggle" class="secondary">👁️ مخفی/نمایش</button>
    </div>
    <div id="output" class="list"></div>
  </div>
</div>
<script>
const THEME_KEY="theme",BG_KEY="bg",themeSelect=document.getElementById("theme");
function applyTheme(n){document.body.classList.remove("theme-light","theme-dark","theme-blue","theme-purple","theme-gradient");document.body.classList.add("theme-"+n);localStorage.setItem(THEME_KEY,n);}
(function(){const s=localStorage.getItem(THEME_KEY)||"light";themeSelect.value=s;applyTheme(s);})();
themeSelect.addEventListener("change",e=>applyTheme(e.target.value));
const BG_CLASSES=["bg-1","bg-2","bg-3","bg-4","bg-img-1","bg-img-2"];let bgIndex=0;
function applyBg(i){document.body.classList.remove(...BG_CLASSES);if(i!==null)document.body.classList.add(BG_CLASSES[i]);}
(function(){const s=localStorage.getItem(BG_KEY);if(s!==null&&s!="-1"){bgIndex=parseInt(s,10);applyBg(bgIndex);}})();
document.getElementById("btnBg").onclick=()=>{bgIndex=(bgIndex+1)%(BG_CLASSES.length+1);if(bgIndex===BG_CLASSES.length){applyBg(null);localStorage.setItem(BG_KEY,-1);bgIndex=-1;}else{applyBg(bgIndex);localStorage.setItem(BG_KEY,bgIndex);}};
function rnd(max){const a=new Uint32Array(1);const m=0xffffffff,l=Math.floor(m/max)*max;let r;do{crypto.getRandomValues(a);r=a[0];}while(r>=l);return r%max;}
function pick(p){return p[rnd(p.length)];}function shuffle(a){for(let i=a.length-1;i>0;i--){const j=rnd(i+1);[a[i],a[j]]=[a[j],a[i]];}return a;}
const sets={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",digits:"0123456789",symbols:"!@#$%^&*()_-+=[]{}|:;,.?/~`<>"},similar=new Set("Il1O0B8S5Z2".split(""));
function pool(o){let ps=[];if(o.lower)ps.push(sets.lower);if(o.upper)ps.push(sets.upper);if(o.digits)ps.push(sets.digits);if(o.symbols)ps.push(sets.symbols);if(o.noSimilar)ps=ps.map(s=>[...s].filter(c=>!similar.has(c)).join(""));return{ps:ps,p:ps.join("")};}
function genPass(o){const{ps,p}=pool(o);if(!p)return"";const L=o.length,chs=[];if(o.requireEach)ps.forEach(s=>chs.push(pick(s)));while(chs.length<L){const c=pick(p);if(o.noRepeat&&chs.length&&chs[chs.length-1]===c)continue;chs.push(c);}return shuffle(chs).slice(0,L).join("");}
const letters="abcdefghijklmnopqrstuvwxyz",nums="0123456789";
function genMail(L,dot){let a=dot?(letters+nums+"."):(letters+nums),s=letters[rnd(letters.length)];while(s.length<L){const c=pick(a);if(c==="."&&(s[s.length-1]=="."||s.length===L-1))continue;s+=c;}if(s.endsWith("."))s=s.slice(0,-1)+letters[rnd(letters.length)];return s;}
let last=[],hidden=false;
function render(list){last=list;const out=document.getElementById("output");out.innerHTML="";list.forEach(x=>{const row=document.createElement("div");row.className="password";const span=document.createElement("span");span.textContent=hidden?"•".repeat(x.length):x;span.dataset.real=x;const copy=document.createElement("button");copy.className="secondary";copy.textContent="📋";copy.onclick=()=>navigator.clipboard.writeText(x);row.appendChild(span);row.appendChild(copy);out.appendChild(row);});}
function opts(){return{lower:lower.checked,upper:upper.checked,digits:digits.checked,symbols:symbols.checked,noSimilar:noSimilar.checked,noRepeat:noRepeat.checked,requireEach:requireEach.checked,length:parseInt(length.value||12)};}
function genMany(){const c=Math.min(100,Math.max(1,parseInt(count.value||5)));const o=opts();const arr=[];for(let i=0;i<c;i++)arr.push(genPass(o));render(arr);}
btnGen.onclick=genMany;btnEmail.onclick=()=>{const c=Math.min(100,Math.max(1,parseInt(count.value||5)));let L=parseInt(emailLen.value||10);if(isNaN(L))L=10;L=Math.max(6,Math.min(30,L));const arr=[];for(let i=0;i<c;i++)arr.push(genMail(L,emailDot.checked)+"@gmail.com");render(arr);}
btnCSV.onclick=()=>{if(!last.length)return;const b=new Blob([last.join("\n")],{type:"text/csv"});const a=document.createElement("a");a.href=URL.createObjectURL(b);a.download="output.csv";a.click();}
btnJSON.onclick=()=>{if(!last.length)return;const b=new Blob([JSON.stringify(last,null,2)],{type:"application/json"});const a=document.createElement("a");a.href=URL.createObjectURL(b);a.download="output.json";a.click();}
btnToggle.onclick=()=>{hidden=!hidden;document.querySelectorAll("#output .password span").forEach(el=>{el.textContent=hidden?"•".repeat(el.dataset.real.length):el.dataset.real;});}
genMany();
</script>
<script>
if('serviceWorker'in navigator){navigator.serviceWorker.register('./sw.js').catch(console.log);}
</script>
</body>
</html>